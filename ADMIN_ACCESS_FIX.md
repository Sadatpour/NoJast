# راهنمای رفع مشکل دسترسی پنل ادمین

این راهنما به شما کمک می‌کند تا مشکل دسترسی به پنل ادمین را حل کنید. لطفا مراحل زیر را به ترتیب دنبال کنید.

## مرحله ۱: بررسی و اصلاح دیتابیس

ابتدا باید مطمئن شوید که جدول `users` در دیتابیس Supabase شما دارای ستون `is_admin` است:

1. وارد پنل Supabase خود شوید: https://supabase.com/dashboard/project/xfckkfrfkwiymksbqnjn
2. به بخش **SQL Editor** بروید
3. یک Query جدید ایجاد کنید و دستور SQL زیر را اجرا کنید:

```sql
ALTER TABLE users ADD COLUMN IF NOT EXISTS is_admin BOOLEAN NOT NULL DEFAULT false;
```

4. دکمه **Run** را کلیک کنید

## مرحله ۲: تعیین کاربر به عنوان ادمین

برای تعیین یک کاربر به عنوان ادمین:

1. در پنل Supabase، به بخش **Table Editor** بروید
2. جدول `users` را انتخاب کنید
3. کاربر مورد نظر خود را پیدا کنید (با استفاده از ایمیل یا شناسه کاربری)
4. روی ردیف کاربر کلیک کنید و ستون `is_admin` را به `true` تغییر دهید
5. تغییرات را ذخیره کنید

## مرحله ۳: تست دسترسی ادمین با ابزار آزمایش

برای بررسی صحت تنظیمات:

1. با کاربری که می‌خواهید ادمین باشد وارد سایت شوید
2. به آدرس زیر بروید:
   ```
   /admin/debug/admin-test
   ```
3. در این صفحه، شناسه کاربر شما نمایش داده می‌شود
4. دکمه "تست دسترسی" را بزنید و نتیجه را مشاهده کنید
5. اگر ستون `is_admin` برای کاربر وجود ندارد یا مقدار آن `false` است، می‌توانید با دکمه "ادمین کردن" این مقدار را به `true` تغییر دهید

## مرحله ۴: حل مشکل مسیریابی

در برنامه، دو مسیر مختلف برای پنل ادمین وجود دارد که ممکن است باعث سردرگمی شود:

1. مسیر `src/app/(admin)/admin` - گروه‌بندی با قالب ادمین
2. مسیر `src/app/admin` - پنل ادمین اصلی

برای دسترسی به پنل ادمین اصلی، باید از آدرس `/admin` (بدون پرانتز) استفاده کنید.

## مرحله ۵: پاکسازی کش و کوکی‌ها

گاهی کش مرورگر و کوکی‌ها می‌توانند باعث مشکلات دسترسی شوند:

1. کوکی‌های مرورگر خود را پاک کنید
2. از مرورگر خارج شوید و دوباره وارد شوید
3. مرورگر را بسته و دوباره باز کنید
4. با ورود مجدد به سایت، دسترسی ادمین خود را بررسی کنید

## مرحله ۶: بررسی اگر مشکل همچنان ادامه دارد

اگر با وجود انجام همه مراحل بالا، همچنان مشکل دارید:

1. مطمئن شوید که برنامه از آخرین نسخه کد استفاده می‌کند
2. سرور را کاملاً متوقف کرده و دوباره راه‌اندازی کنید
3. به آدرس `/admin/debug/admin-test` بروید و از نتایج آزمون برای عیب‌یابی بیشتر استفاده کنید

## نکات مهم

- تغییرات در Supabase ممکن است چند ثانیه طول بکشد تا اعمال شود
- اطمینان حاصل کنید که در همان حساب کاربری هستید که آن را به عنوان ادمین تعیین کرده‌اید
- اگر از حساب کاربری جدیدی استفاده می‌کنید، مطمئن شوید که آن را به درستی به عنوان ادمین تنظیم کرده‌اید 